(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[9],{"23fe":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",[i("q-btn",{staticClass:"text-bold sm-btn q-mb-md",attrs:{color:"primary",flat:"",icon:"arrow_back_ios",label:"Back to Invoices","no-caps":"",to:"/invoices"}}),t.invoice?i("section",[i("div",{staticClass:"row justify-between q-py-sm"},[i("div",{staticClass:"text-bold invoice-ref"},[t._v("INVOICE #"+t._s(t.invoice.ref))]),i("div",["paid"===t.invoice.status?i("div",{staticClass:"inline-block text-14"},[t._v("\n                    Date Paid:\n                    "),i("span",{staticClass:"text-bold"},[t._v(t._s(t._f("moment")(t.invoice.paid_at,"MMMM Do, YYYY")))])]):"issued"===t.invoice.status?i("div",{staticClass:"inline-block text-14"},[t._v("\n                    Date Issued:\n                    "),i("span",{staticClass:"text-bold"},[t._v(t._s(t._f("moment")(t.invoice.issued_at,"MMMM Do, YYYY")))])]):i("div",{staticClass:"inline-block text-14"},[t._v("\n                    Created:\n                    "),i("span",{staticClass:"text-bold"},[t._v(t._s(t._f("moment")(t.invoice.created_at,"MMMM Do, YYYY")))])]),i("q-chip",{class:{"bg-light-blue-4":"draft"===t.invoice.status,"bg-amber":"issued"===t.invoice.status,"bg-green-8":"paid"===t.invoice.status,"bg-red-8":"due"===t.invoice.status,"text-white q-px-lg status q-ml-md":!0}},[t._v("\n                    "+t._s(t._f("firstCaps")(t.invoice.status))+"\n                ")])],1)]),i("div",{staticClass:"bg-white shadow-custom main-section"},[i("section",{staticClass:"row justify-between q-px-lg q-py-lg"},[i("div",{staticClass:"row q-gutter-xl"},[i("div",{staticClass:"column"},[i("div",{staticClass:"subject-header"},[t._v("Amount Due")]),i("div",[t._v(t._s(t.invoice.currency.iso)+" "+t._s(t.invoice.total_amt))])]),i("div",{staticClass:"column"},[i("div",{staticClass:"subject-header"},[t._v("Due Date")]),i("div",[t._v(t._s(t.invoice.currency.iso)+" "+t._s(t._f("moment")(t.invoice.due_date,"MMM DD, YYYY")))])])]),i("div",{staticClass:"q-gutter-md"},[i("q-btn",{staticClass:"shadow-btn text-bold sm-btn",attrs:{color:"white",icon:"save_alt",label:"Download","no-caps":"","text-color":"black",unelevated:""},on:{click:function(e){return t.downloadInvoice(t.invoice.id)}}}),i("q-btn",{staticClass:"shadow-btn text-bold sm-btn",attrs:{color:"orange-4","icon-right":"keyboard_arrow_down",label:"Edit Invoice","no-caps":"","text-color":"white",unelevated:""}},[i("q-menu",{attrs:{offset:[0,15]}},[i("q-list",{staticStyle:{"min-width":"100px"}},["paid"!==t.invoice.status?i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:t.editInvoice}},[i("q-item-section",[t._v("Edit Invoice")])],1):t._e(),"paid"!==t.invoice.status?i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:t.sendInvoice}},[i("q-item-section",[t._v(t._s("issued"===t.invoice.status?"Res":"S")+"end Invoice\n                                    ")])],1):t._e(),i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:t.deleteInvoice}},[i("q-item-section",{staticClass:"text-negative"},[t._v("Delete Invoice")])],1)],1)],1)],1),"paid"!==t.invoice.status?i("q-btn",{staticClass:"shadow-btn text-bold sm-btn",attrs:{color:"green-8",label:"Mark as Paid","no-caps":"","text-color":"white",unelevated:""},on:{click:function(e){return t.markAsPaid(t.invoice.id)}}}):t._e()],1)])]),i("div",{staticClass:"row section-header"},[t._v("Customer Information")]),i("div",{staticClass:"bg-white shadow-custom main-section"},[i("section",{staticClass:"row justify-between q-px-lg q-py-lg"},[i("div",{staticClass:"row q-gutter-xl"},[t._m(0),t._m(1),i("div",{staticClass:"column"},[i("div",{staticClass:"subject-header"},[t._v("Email")]),i("div",[t._v(t._s(t.invoice.to_email))])]),t.invoice.cc_emails?i("div",{staticClass:"column"},[i("div",{staticClass:"subject-header"},[t._v("Cc emails")]),i("div",[t._v(t._s(t.invoice.cc_emails))])]):t._e()])])]),i("div",{staticClass:"row section-header"},[t._v("Invoice Details")]),i("div",{staticClass:"row justify-between bg-white shadow-custom main-section"},[i("section",{staticClass:"col-7 q-px-lg q-py-lg"},[i("q-markup-table",{staticClass:"no-shadow no-click"},[i("thead",[i("tr",[i("th",{staticClass:"text-center"},[t._v("Item")]),i("th",{staticClass:"text-center"},[t._v("Quantity")]),i("th",{staticClass:"text-center"},[t._v("Unit Price")])])]),i("tbody",t._l(t.invoice.items,(function(e,s){return i("tr",{key:e.id,staticClass:"ref_table_body"},[[i("td",{staticClass:"text-center"},[t._v(t._s(e.item))]),i("td",{staticClass:"text-center"},[t._v(t._s(e.quantity))]),i("td",{staticClass:"text-center"},[t._v(t._s(t._f("formatAmount")(e.unit_price)))])]],2)})),0)])],1),i("section",{staticClass:"col-4 q-pr-lg q-py-lg summary"},[i("div",{staticClass:"row justify-between"},[i("span",[t._v("Subtotal")]),i("span",[t._v(t._s(t.invoice.currency.iso)+" "+t._s(t._f("formatAmount")(t.subtotal)))])]),i("div",{staticClass:"row justify-between"},[i("span",[t._v("Shipping Fee")]),i("span",[t._v(t._s(t.invoice.currency.iso)+" "+t._s(t._f("formatAmount")(t.invoice.shipping_fee)))])]),i("div",{staticClass:"row justify-between"},[i("span",[t._v("Discount")]),i("span",[t._v(t._s(t.invoice.currency.iso)+" "+t._s(t._f("formatAmount")(t.invoice.discount)))])]),i("div",{staticClass:"row justify-between"},[i("span",[t._v("VAT")]),i("span",[t._v(t._s(t.invoice.currency.iso)+" "+t._s(t._f("formatAmount")(t.invoice.tax)))])]),i("div",{staticClass:"row justify-between text-bold q-mt-md q-pt-md",staticStyle:{"border-top":"1px solid whitesmoke"}},[i("span",[t._v("Total")]),i("span",[t._v(t._s(t.invoice.currency.iso)+"  "+t._s(t._f("formatAmount")(t.total)))])])]),t.invoice.notes?i("section",{staticClass:"q-px-lg main-section"},[t._m(2),i("div",[t._v(t._s(t.invoice.notes))])]):t._e()])]):i("section",{staticClass:"row justify-center"},[i("q-spinner",{staticClass:"q-mt-xl",attrs:{thickness:1,color:"orange-4",size:"4em"}})],1)],1)},n=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"column"},[i("div",{staticClass:"subject-header"},[t._v("Customer Name")]),i("div",[t._v("Anonymous Customer")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"column"},[i("div",{staticClass:"subject-header"},[t._v("Phone Number")]),i("div",[t._v("N/A")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"row subject-header"},[i("div",[t._v("Notes")])])}],a=(i("8e6e"),i("8a81"),i("ac6a"),i("cadf"),i("456d"),i("6b54"),i("06db"),i("967e")),o=i.n(a),c=(i("96cf"),i("fa84")),r=i.n(c),l=i("c47a"),u=i.n(l),v=i("6fea"),d=i("5935");function p(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function m(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?p(Object(i),!0).forEach((function(e){u()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):p(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var f={name:"InvoiceDetails",meta:function(){return{title:"View Invoice Details - Invoices"}},props:["id"],data:function(){return{dialog:!1,invoice:null,processing:!1}},computed:m({subtotal:function(){return this.$collect(this.invoice.items).filter((function(t,e){return t.unit_price&&t.quantity})).sum((function(t){return t.unit_price*t.quantity}))},total:function(){return parseFloat(this.subtotal)+parseFloat(this.invoice.shipping_fee||0)+parseFloat(this.invoice.discount||0)+parseFloat(this.invoice.tax||0)}},Object(d["b"])("invoices",["form"])),created:function(){this.fetchInvoice()},methods:{exportData:function(){var t=this;return r()(o.a.mark((function e(){var i;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.get("invoices/filter",{params:m({export:!0},t.filter)});case 2:return i=e.sent,e.abrupt("return",i.data.data);case 4:case"end":return e.stop()}}),e)})))()},fetchInvoice:function(){var t=this;return r()(o.a.mark((function e(){var i,s,n,a,c;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.processing=!0,e.next=3,t.$axios.get("invoice/".concat(t.id),{params:t.filter});case 3:i=e.sent,s=i.data,n=s.status,a=s.msg,c=s.data,n?t.invoice=c:t.$q.notify({color:"negative",position:"top-right",message:a,icon:"cancel"}),t.processing=!1;case 7:case"end":return e.stop()}}),e)})))()},deleteInvoice:function(){var t=this;return r()(o.a.mark((function e(){return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$q.dialog({title:"Confirm",message:"The action is irreversible. Are you sure you want to do this?",cancel:!0,persistent:!0,color:"primary"}).onOk(r()(o.a.mark((function e(){var i,s,n,a;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.processing=!0,e.next=3,t.$axios.delete("invoice/".concat(t.id));case 3:i=e.sent,s=i.data,n=s.status,a=s.msg,s.data,n?(t.$q.notify({color:"positive",position:"top-right",message:a,icon:"check_circle"}),t.$router.push("/invoices")):t.$q.notify({color:"negative",position:"top-right",message:a,icon:"cancel"}),t.processing=!1;case 7:case"end":return e.stop()}}),e)}))));case 1:case"end":return e.stop()}}),e)})))()},markAsPaid:function(){var t=this;return r()(o.a.mark((function e(){return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$q.dialog({title:"Confirm",message:"Are you sure you want to do this?",cancel:!0,persistent:!0,color:"positive"}).onOk(r()(o.a.mark((function e(){var i,s,n,a,c;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.processing=!0,e.next=3,t.$axios.post("invoice/".concat(t.id,"/markAsPaid"));case 3:i=e.sent,s=i.data,n=s.status,a=s.msg,c=s.data.invoice,n?(t.$q.notify({color:"positive",position:"top-right",message:a,icon:"check_circle"}),t.invoice=c):t.$q.notify({color:"negative",position:"top-right",message:a,icon:"cancel"}),t.processing=!1;case 7:case"end":return e.stop()}}),e)}))));case 1:case"end":return e.stop()}}),e)})))()},downloadInvoice:function(t){var e=this;return r()(o.a.mark((function i(){var s,n,a,c,r,l,u;return o.a.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return e.processing=!0,i.next=3,e.$axios.post("invoice/".concat(t,"/downloadInvoice"));case 3:s=i.sent,n=s.data,a=n.status,c=n.msg,r=n.data.file,a?(e.$q.notify({color:"positive",position:"top-right",message:c,icon:"check_circle"}),l=new URL(v["a"].invoices(r)),u=document.createElement("a"),u.href=l.toString(),u.setAttribute("download","".concat(r)),document.body.appendChild(u),u.click()):e.$q.notify({color:"negative",position:"top-right",message:c,icon:"cancel"}),e.processing=!1;case 7:case"end":return i.stop()}}),i)})))()},sendInvoice:function(){var t=this;return r()(o.a.mark((function e(){return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$q.dialog({title:"Confirm",message:"Please confirm you really want to do this",cancel:!0,persistent:!0,color:"primary"}).onOk(r()(o.a.mark((function e(){var i,s,n,a,c;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.processing=!0,e.next=3,t.$axios.post("invoice/".concat(t.id,"/sendInvoice"));case 3:i=e.sent,s=i.data,n=s.status,a=s.msg,c=s.data.invoice,n?(t.invoice=c,t.$q.notify({color:"positive",position:"top-right",message:a,icon:"check_circle"})):t.$q.notify({color:"negative",position:"top-right",message:a,icon:"cancel"}),t.processing=!1;case 7:case"end":return e.stop()}}),e)}))));case 1:case"end":return e.stop()}}),e)})))()},editInvoice:function(){delete this.invoice.issued_at,this.invoice.due_date=this.$moment(this.invoice.due_date).format("DD-MM-YYYY"),this.invoice.items=_.map(this.invoice.items,(function(t){return t.title=t.item,t})),this.form=this.invoice,this.$router.push("/invoices/create")},resetFilter:function(){this.filter.email="",this.filter.date_range={from:"",to:""},this.filter.status=[]},firstCaps:function(t){if(null!=t)return t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()}},filters:{}},h=f,w=(i("2d9c"),i("2877")),b=Object(w["a"])(h,s,n,!1,null,"f293485e",null);e["default"]=b.exports},"2d9c":function(t,e,i){"use strict";var s=i("6ecd"),n=i.n(s);n.a},"6ecd":function(t,e,i){}}]);
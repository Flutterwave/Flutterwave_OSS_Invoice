(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[20],{"128d":function(t,e,a){"use strict";var n=a("d8d1"),r=a.n(n);r.a},d8d1:function(t,e,a){},fef1:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"transactions-main q-pa-xl"},[a("div",{staticClass:"row",staticStyle:{"margin-bottom":"1em"}},[a("q-expansion-item",{staticClass:"filter",attrs:{"default-opened":"",icon:"fas fa-filter",label:"Filter"}},[a("div",{staticClass:"row q-gutter-md"},[a("q-input",{attrs:{clearable:"",label:"Loan ID"},on:{input:function(e){(t.filter.loan_id.length>=t.minFilterLength&&/^\d+$/.test(t.filter.loan_id)||0===t.filter.loan_id.length)&&t.filterTransactions()}},model:{value:t.filter.loan_id,callback:function(e){t.$set(t.filter,"loan_id",e)},expression:"filter.loan_id"}}),a("q-input",{attrs:{clearable:"",label:"User ID"},on:{input:function(e){(t.filter.user_id.length>=2&&/^\d+$/.test(t.filter.user_id)||0===t.filter.user_id.length)&&t.filterTransactions()}},model:{value:t.filter.user_id,callback:function(e){t.$set(t.filter,"user_id",e)},expression:"filter.user_id"}}),a("q-input",{attrs:{clearable:"",label:"Reference"},on:{input:function(e){(t.filter.reference.length>=10||0===t.filter.reference.length)&&t.filterTransactions()}},model:{value:t.filter.reference,callback:function(e){t.$set(t.filter,"reference",e)},expression:"filter.reference"}}),a("q-select",{attrs:{options:[{label:"",value:""},{label:"Borrower",value:"0"},{label:"Lender",value:"1"}],"emit-value":"",hint:"Profile type",label:"Type of user","map-options":""},on:{input:t.filterTransactions},model:{value:t.filter.profile_type,callback:function(e){t.$set(t.filter,"profile_type",e)},expression:"filter.profile_type"}}),a("q-select",{attrs:{options:t.transaction_type_options,"emit-value":"",hint:"Type of transaction",label:"Transaction type","map-options":""},on:{input:t.filterTransactions},model:{value:t.filter.transaction_type,callback:function(e){t.$set(t.filter,"transaction_type",e)},expression:"filter.transaction_type"}}),a("q-select",{attrs:{options:t.investment_type_options,"emit-value":"",hint:"Type of investment",label:"Investment class","map-options":""},on:{input:t.filterTransactions},model:{value:t.filter.inv_class,callback:function(e){t.$set(t.filter,"inv_class",e)},expression:"filter.inv_class"}}),a("q-input",{attrs:{clearable:"",hint:"Exactly from this date",label:"Date From"},model:{value:t.filter.date_range.from,callback:function(e){t.$set(t.filter.date_range,"from",e)},expression:"filter.date_range.from"}},[a("q-popup-proxy",{ref:"dateFrom",attrs:{"transition-hide":"scale","transition-show":"scale"}},[a("q-date",{attrs:{mask:"DD-MM-YYYY"},on:{input:function(){t.$refs.dateFrom.hide(),t.filterTransactions()}},model:{value:t.filter.date_range.from,callback:function(e){t.$set(t.filter.date_range,"from",e)},expression:"filter.date_range.from"}})],1)],1),a("q-input",{attrs:{clearable:"",hint:"Exactly to this date",label:"Date To"},model:{value:t.filter.date_range.to,callback:function(e){t.$set(t.filter.date_range,"to",e)},expression:"filter.date_range.to"}},[a("q-popup-proxy",{ref:"dateTo",attrs:{"transition-hide":"scale","transition-show":"scale"}},[a("q-date",{attrs:{mask:"DD-MM-YYYY"},on:{input:function(){t.$refs.dateFrom.hide(),t.filterTransactions()}},model:{value:t.filter.date_range.to,callback:function(e){t.$set(t.filter.date_range,"to",e)},expression:"filter.date_range.to"}})],1)],1)],1)])],1),t.transactionsData.length?a("div",{staticClass:"row q-pt-md"},[a("json-excel",{staticClass:"col-sm-2",attrs:{fetch:t.exportData,fields:t.csv_fields,name:"Transactions.csv",type:"csv"}},[a("q-btn",{staticStyle:{"-webkit-border-radius":"2px","-moz-border-radius":"2px","border-radius":"2px"},attrs:{color:"secondary",icon:"fas fa-save",label:"EXPORT",size:"sm",unelevated:""}})],1),a("span",{staticClass:"col-sm-5"}),a("q-select",{staticClass:"col-sm-2",staticStyle:{"margin-top":"0","font-size":"12px"},attrs:{options:[{label:"50 per page",value:"50"},{label:"100 per page",value:"100"},{label:"200 per page",value:"200"},{label:"500 per page",value:"500"},{label:"1000 per page",value:"1000"}],dense:"","emit-value":"","map-options":""},on:{change:t.filterTransactions},model:{value:t.filter.per_page,callback:function(e){t.$set(t.filter,"per_page",e)},expression:"filter.per_page"}}),a("span",{staticClass:"col-sm-1"}),a("span",{staticClass:"col-sm-2",staticStyle:{"font-weight":"lighter",color:"gray","font-size":"12px","padding-top":"14px"}},[t._v("\n            "+t._s(t.entries.to)+" out of "+t._s(t.entries.total))])],1):t._e(),a("div",{staticClass:"row justify-center",staticStyle:{"margin-top":"30px"}},[t.transactionsData.length>0?a("table",{staticClass:"q-table loose"},[t._m(0),a("tbody",t._l(t.transactionsData,(function(e,n){return a("tr",[a("td",{staticClass:"text-center"},[t._v(t._s(e.id))]),a("td",{staticClass:"text-center"},[t._v(t._s(e.confirmation))]),a("td",{staticClass:"text-center",attrs:{title:"Click to navigate to loan details"},on:{click:function(a){return t.gotoLoan(e.related_loan)}}},[t._v(" "+t._s(e.related_loan)+"\n                ")]),a("td",{staticClass:"text-center"},[t._v(t._s(t._f("formatTransType")(e.transaction_type.type))+"\n                ")]),a("td",{staticClass:"text-center"},[t._v("â‚¦"+t._s(t._f("formatAmount")(e.amount)))]),a("td",{staticClass:"text-center"},[t._v(t._s(e.user_id))]),a("td",{staticClass:"text-center"},[t._v(t._s(t.getInvestmentType(e.inv_type_id)))]),a("td",{staticClass:"text-center"},[t._v(t._s(t._f("moment")(e.date_created,"MMM Do, YYYY hh:mm A")))])])})),0)]):t._e()]),t.transactionsData.length<t.entries.total?a("div",{staticClass:"row justify-center"},[a("q-infinite-scroll",{attrs:{handler:t.refresher,offset:500}},[a("q-spinner-puff",{staticStyle:{"margin-top":"30px"},attrs:{slot:"message",size:40,color:"primary"},slot:"message"})],1)],1):t._e()])},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",[t._v("ID")]),a("th",[t._v("REFERENCE")]),a("th",[t._v("INV. ID")]),a("th",[t._v("TRANSACTION TYPE")]),a("th",[t._v("AMOUNT")]),a("th",[t._v("USER ID")]),a("th",[t._v("TYPE")]),a("th",[t._v("DATE")])])])}],i=(a("8e6e"),a("8a81"),a("456d"),a("28a5"),a("6b54"),a("a481"),a("4db1")),s=a.n(i),l=(a("ac6a"),a("cadf"),a("06db"),a("967e")),o=a.n(l),c=a("c47a"),f=a.n(c),u=(a("96cf"),a("fa84")),p=a.n(u),d=a("b178"),h=a("1bdd");function v(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function _(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?v(Object(a),!0).forEach((function(e){f()(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var b={name:"Transactions",meta:function(){return{title:"Transactions"}},components:{JsonExcel:h["a"]},data:function(){return{activeNames:["1"],filter:{loan_id:"",user_id:"",profile_type:"",transaction_type:"",reference:"",date_range:{from:"",to:""},inv_class:"",page:1,per_page:"100"},transactionsData:[],transaction_type_options:[{label:"",value:""},{label:"Note Pledge",value:1},{label:"Loan Disbursement",value:2},{label:"Borrower Payback",value:3},{label:"Lender Payback",value:4},{label:"Subscription Fee",value:5},{label:"Risk Assessment Fee",value:6},{label:"Closing Fee",value:7},{label:"Late Fee",value:8},{label:"Note Refund",value:9},{label:"Exhausted Loan Refund",value:10},{label:"Cancelled Loan Refund",value:11},{label:"Operation Fee",value:12},{label:"Wire Fee",value:13},{label:"Transaction Refund",value:14},{label:"Note Transfer",value:16},{label:"Note TopUp",value:17},{label:"SafeKeep",value:20},{label:"FreeSafe",value:21},{label:"Wallet Fund",value:22},{label:"Wallet Withdraw",value:24}],investment_type_options:[{label:"",value:""},{label:"Loan",value:"1"},{label:"Asset",value:"2"},{label:"Wallet",value:"3"}],text:"",csv_fields:{"Investment ID":"related_loan","User ID":"user_id","Profile Type":"profile","Transaction Type":"transaction_type.type",Amount:"amount",Reference:"confirmation",Date:"date_created"},entries:{to:"",total:""},minFilterLength:3}},computed:{},mounted:function(){},methods:{exportData:function(){var t=this;return p()(o.a.mark((function e(){var a;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.get("transactions/filter",{params:_({export:!0},t.filter)});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))()},fetchTransactions:function(){this.$axios.get("transactions/fetch").then(function(t){this.transactionsData=t.data.data,this.entries.to=t.data.to,this.entries.total=t.data.total}.bind(this)).catch(function(t){console.error(t)}.bind(this))},refresher:function(t,e){this.filter.page++,this.$axios.get("transactions/filter",{params:this.filter}).then(function(t){var a;(a=this.transactionsData).push.apply(a,s()(t.data.data)),this.entries.to=t.data.to,this.entries.total=t.data.total,e()}.bind(this)).catch(function(t){e(),console.error(t)}.bind(this))},filterTransactions:Object(d["e"])((function(){this.filter.page=1,this.$axios.get("transactions/filter",{params:this.filter}).then(function(t){this.transactionsData=t.data.data,this.entries.to=t.data.to,this.entries.total=t.data.total}.bind(this)).catch(function(t){console.error(t)}.bind(this))}),1e3),gotoLoan:function(t){this.$router.push({path:"loans",query:{id:t}})},getInvestmentType:function(t){return 1===t?"LOAN":2===t?"ASSET":3===t?"WALLET":void 0},refreshEntries:function(){this.resetFilterData(),this.fetchTransactions()},resetFilterData:function(){this.filter.lender_id="",this.filter.f_name="",this.filter.l_name="",this.filter.username="",this.filter.phone="",this.filter.email=""},showAlert:function(t,e){var a=Alert.create({enter:"bounceInRight",leave:"bounceOutRight",color:t,html:e,position:"top-right",duration:3e3});setTimeout((function(){a.dismiss()}),3e3)},firstCaps:function(t){if(null!=t)return t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()}},filters:{firstCaps:function(t){if(null!=t)return t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()},formatAmount:function(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},formatTransType:function(t){var e="",a=t.split("_");return a.forEach((function(t){e+=t.toUpperCase()+" "})),e}}},m=b,g=(a("128d"),a("2877")),y=Object(g["a"])(m,n,r,!1,null,"1279cf47",null);e["default"]=y.exports}}]);